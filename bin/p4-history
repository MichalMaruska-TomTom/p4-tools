#! /bin/bash -eu


limit=20

usage()
{
    cat <<EOF
usage: ${0##*/} [+-n number] [--] ARGS...

Shows the submitted changelists...
-n         possibly with a limit.
ARGS...   limits to that part of repository.

EOF
}


while getopts :n:h OPT; do
    case $OPT in
	n|+n)
	    limit=$OPTARG
	    ;;
	h)
	    usage
	    exit 0
	    ;;
	*)
	    usage
	    exit 2
    esac
done
shift $(( OPTIND - 1 ))
OPTIND=1

if [ $# -gt 0 ]
then
    where=$@
else
    where=$(p4-root)/...
fi


p4 changelists -l -s submitted -m $limit $where |\
 sed --quiet -f ${P4SHARE-/usr/share/p4-tools/}/p4-changelists.color.sed
